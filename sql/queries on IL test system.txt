select distinct FTM.NAME as Generic, EPMM.NAME as Instance, EPM.FAMILYTABLESTATUS
from EPMSEPFAMILYTABLEMASTER FTM, EPMSEPFAMILYTABLE FT, EPMCONTAINEDIN CI, EPMDOCUMENT EPM, EPMDOCUMENTMASTER EPMM
where FT.IDA3MASTERREFERENCE=FTM.IDA2A2
and CI.IDA3B5=FT.IDA2A2
and EPM.IDA2A2=CI.IDA3A5
and EPMM.IDA2A2=EPM.IDA3MASTERREFERENCE
order by EPM.FAMILYTABLESTATUS desc, EPMM.NAME;

select distinct CI1.IDENTIFIER as Generic1, EPMM1.CADNAME as Instance1, EPM1.FAMILYTABLESTATUS,
CI2.IDENTIFIER as Generic2, EPMM2.CADNAME as Instance2, EPM2.FAMILYTABLESTATUS
from EPMSEPFAMILYTABLEMASTER FTM1, EPMSEPFAMILYTABLE FT1, EPMCONTAINEDIN CI1, EPMDOCUMENT EPM1, EPMDOCUMENTMASTER EPMM1,
EPMSEPFAMILYTABLEMASTER FTM2, EPMSEPFAMILYTABLE FT2, EPMCONTAINEDIN CI2, EPMDOCUMENT EPM2, EPMDOCUMENTMASTER EPMM2
where FT1.IDA3MASTERREFERENCE=FTM1.IDA2A2
and CI1.IDA3B5=FT1.IDA2A2
and EPM1.IDA2A2=CI1.IDA3A5
and EPMM1.IDA2A2=EPM1.IDA3MASTERREFERENCE
and EPMM1.CADNAME=CI2.IDENTIFIER
and FT2.IDA3MASTERREFERENCE=FTM2.IDA2A2
and CI2.IDA3B5=FT2.IDA2A2
and EPM2.IDA2A2=CI2.IDA3A5
and EPMM2.IDA2A2=EPM2.IDA3MASTERREFERENCE
--and EPM2.FAMILYTABLESTATUS=3
--and FTM1.name='socket_screw_mm.prt'
order by EPM1.FAMILYTABLESTATUS, EPMM1.CADNAME desc;

select distinct EPMM1.CADNAME AS GENERIC, EPMM2.CADNAME AS SUBGENERIC, EPM2.FAMILYTABLESTATUS, EPMM3.CADNAME AS INSTANCE, EPM3.FAMILYTABLESTATUS
from EPMDOCUMENTMASTER EPMM1, EPMCONTAINEDIN CI1, EPMDOCUMENT EPM2, EPMDOCUMENTMASTER EPMM2, EPMCONTAINEDIN CI2, EPMDOCUMENT EPM3, EPMDOCUMENTMASTER EPMM3
where EPMM1.CADNAME=CI1.IDENTIFIER
and EPM2.IDA2A2=CI1.IDA3A5
and EPMM2.IDA2A2=EPM2.IDA3MASTERREFERENCE
and EPMM2.CADNAME=CI2.IDENTIFIER
and EPM3.IDA2A2=CI2.IDA3A5
and EPMM3.IDA2A2=EPM3.IDA3MASTERREFERENCE
--and EPM2.FAMILYTABLESTATUS=3
--and FTM1.name='socket_screw_mm.prt'
order by EPM2.FAMILYTABLESTATUS, EPMM1.CADNAME;


select distinct FTM.NAME as Generic, EPMM.NAME as Instance, EPM.FAMILYTABLESTATUS
from EPMSEPFAMILYTABLEMASTER FTM, EPMSEPFAMILYTABLE FT, EPMCONTAINEDIN CI, EPMDOCUMENT EPM, EPMDOCUMENTMASTER EPMM,

where FT.IDA3MASTERREFERENCE=FTM.IDA2A2
and CI.IDA3B5=FT.IDA2A2
and EPM.IDA2A2=CI.IDA3A5
and EPMM.IDA2A2=EPM.IDA3MASTERREFERENCE
--and FTM.name='289065-xx.prt'
order by EPM.FAMILYTABLESTATUS, EPMM.NAME desc;


select FTM.NAME as Generic, EPMM.NAME as Instance, EPM.FAMILYTABLESTATUS
from EPMDOCUMENTMASTER EPMM, EPMDOCUMENT EPM, EPMCONTAINEDIN CI, EPMSEPFAMILYTABLE FT, EPMSEPFAMILYTABLEMASTER FTM
where EPMM.IDA2A2=EPM.IDA3MASTERREFERENCE
and EPM.IDA2A2=CI.IDA3A5
and CI.IDA3B5=FT.IDA2A2
and FT.IDA3MASTERREFERENCE=FTM.IDA2A2
and CADNAME in (select FTM.NAME
from EPMSEPFAMILYTABLEMASTER FTM)
order by familytablestatus, cadname;

select * from epmdocument epm, epmdocumentmaster epmm
where name like '%.drw'
and epmm.ida2a2=epm.ida3masterreference;


select distinct epmm1.name as DWG, epmm2.name as Parent
from epmdocumentmaster epmm1, epmdocument epm, epmreferencelink link, epmdocumentmaster epmm2
where link.referencetype='DRAWING'
and epmm1.ida2a2=epm.ida3masterreference
and epm.ida2a2=link.ida3a5
and link.ida3b5=epmm2.ida2a2
order by epmm1.name;

SELECT * FROM EPMCONTAINEDIN WHERE IDENTIFIER='pem_standoff_mm.prt';

SELECT LOWER(DOCUMENTNUMBER), CADNAME FROM EPMDOCUMENTMASTER EPMM WHERE LOWER(EPMM.DOCUMENTNUMBER) <> epmm.cadname;
